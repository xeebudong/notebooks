10 大 Tableau 表计算
https://www.tableau.com/zh-cn/about/blog/2017/2/top-10-tableau-table-calculations-65417?__src=liftigniter&__widget=blog-widget&li_source=LI&li_medium=blog-widget
此处将介绍 Tableau 强大表计算功能的 10 个示例。大多数示例需要编写某种简单的公式。每个示例都以选项卡式视图形式提供一个真实示例和相关说明。您可以下载任何工作簿进行更深入的研究。

为查看并重新创建这些表计算，您需要一份 Tableau Desktop。可在此处获得 14 天免费试用版。

表计算基础知识

表计算依赖两种类型的字段：寻址字段和分区字段。了解表计算的关键是弄清楚这些字段的工作方式。

顾名思义，分区字段执行以下操作：将数据分成多个单独的存储桶，并对每个存储桶执行计算。
寻址字段则用于定义执行计算的“方向”。

在右侧示例中，有一个销售额汇总。“Segment”（细分市场）是分区字段，因此汇总涵盖两个细分市场“consumer”（消费者）和“corporate”（公司）。“Date”（日期）是寻址字段，因此两个细分市场的销售额将按时间汇总。

1.自参考日期开始的百分比变化

利用表计算，可以计算从任意值开始的百分比变化。假设您对某个股票组合感兴趣，并且想评估它们从某个时间点开始的相对表现。为此，需要设置一个“投资日期”，并将这些股票标准化到同一个时间点，用线条显示百分比变化。可使用滑块调整参考日期。


使用一个表示参考日期的参数和 WINDOW_MAX 函数来获得参考日期当日的收盘价，这样就能计算股票的相对收益。

2.公共基准（《玩具总动员》）

您可能想参照一个公共基准点查看数据，而不是查看一段绝对时间范围的数据。例如，这里有三部《玩具总动员》电影的票房收入。如果按星期看一下自首映日开始的总收入，比较起来就容易多了：


使用 Tableau 的 INDEX() 函数，可轻松计算自首映开始的星期数。在这个例子中，您按电影分区，按天数寻址。

3.随时间变化的销售总额百分比（多遍聚合）

希望一次执行两遍表计算的情况很常见。例如，查看某个细分市场随时间变化的增长或收缩对公司的重要性可能很有意义。为此，必须先按细分市场计算随时间变化的销售额汇总，然后将其作为随时间变化的销售总额百分比来查看。这也称为多遍聚合，在 Tableau 中不写公式也可以完成这种聚合。


第 1 遍按细分市场计算随时间变化的销售额汇总。第 2 遍将每个细分市场的汇总计算为随时间变化的总计百分比。

4.整理时保持排序

这里我们需要了解产品在一个月和一年内的排名，然后显示排名随时间的变化。为此，我们创建一个凹凸图，其中以折线图形式显示随时间的变化。可在左侧看到复印机和传真机已经从销售不佳的产品变成目前的销售前 3 甲。还可以看到，传真机和复印机的购买量波动很大。


经典凹凸图。此图显示采用简单 Rank (index()) 计算和某些高级设置计算的每样产品的销售名次。

5.汇总

现在需要监视呼叫中心未结支持案例的数量，或者有货的库存数量。但是系统未记录未结案例的滚动合计，您需要推算出来。这等于开案日的案例数 + 新开案例数 + 重开案例数 – 已结案例数。

表面看来，这是简单计算。但是，每日开案数量是根据上一个结案日推算的，后者又是根据当日开案数量推算的。这形成了计算的循环引用。


我们使用 WINDOW_SUM 来计算汇总，并确定每天的结案量。

6.加权平均

对于考试分数或订单优先级等数据，适合采用加权平均分析。也许您想查看各种产品类型所有订单的平均优先级，并且想按订购量加权该优先级，这样订购量大的产品就会得到更高的优先级分数。可以使用加权平均优先级分数来优化订购量大、优先级高的产品的供应链。这里，我们使用 Superstore 销售数据进行加权平均：


这里，我们又一次使用 WINDOW_SUM 来计算每个类别的权重，然后将该权重应用于优先级分数。

7.按计算分组

如果您管理公司的配送运营，可能会对哪些产品的运输成本高于平均值感兴趣。在 Tableau 6 中，可以计算整个时间窗口的平均值，并在计算中使用该值对各值进行分组和配色。


8.移动范围的事件数

对于零售、智能或边界控制等不同的场景，通常需要了解在一个时间窗口内发生某一事件的次数。例如，一次可疑事件可能是一次意外，但是如果在 x 天里发生次数超过 n 次，那就值得调查一下。


圆点表示警报或警告的数量出现上升 – 通常为 0。0 上面的点表示当天触发的警报，条形表示警告在 x 天里触发超过 n 次。用户可单击右键，同时显示点和条形的数据。

9.可变时段的移动平均

您已使用 Tableau 中的快速表计算功能，计算了所有月份的销售额移动平均，但现在希望进行扩展，以便选择要计算多少个时段的平均值。

淡蓝色线条显示所有月份的销售额总和，而橙色线条显示 15 个时段的销售额移动平均。


结合使用参数和用于计算移动平均的自定义快速表计算，可计算可变时段的平均值。

10.各时段与平均值的差异

您可能更想看到季度销售额与当年平均值（而不是绝对数）的差异。此处显示了与当年平均值和绝对订单数之间的差异。


Read more at https://www.tableau.com/zh-cn/about/blog/2017/2/top-10-tableau-table-calculations-65417#CHaGjf6DhGR7xeOR.99