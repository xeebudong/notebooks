# SAS数据集合并-update、merge、modify的区别与特性

## 1. 原理
> update\merge\modify\set操作数据流，参考《深入解析SAS》



## 2. 性能
## 3. 比较
## 4. 应用


## 参考文献
1. [SET MERGE UPDATE MODIFY语句对比](http://blog.sina.com.cn/s/blog_6c1c13fc0100lyi7.html)
2. [sas数据操作update、modify by ke=、控制modify的更新、datasets添加约束条件、操作文件变动aduit trail](https://www.cnblogs.com/yican/p/3799883.html)
3. [SAS进阶《深入解析SAS》之对多数据集的处理](https://blog.csdn.net/dream_an/article/details/50455511)
4. [sas中modify比merge、update效率高嘛？](http://bbs.pinggu.org/thread-2145851-1-1.html)


## SAS日期函数
如何获得月份的最后一天

https://communities.sas.com/t5/SAS-Procedures/How-to-find-the-last-date-of-a-month/td-p/71526
https://philihp.com/blog/2011/how-to-get-the-last-day-of-a-month-in-sas/

data a;     
aeendtc1='2007-09';
aeendtc2=input(aeendtc1,anydtdte7.);
lastDay=intnx ('month',aeendtc2,0,'E');
mydate=put(lastday,yymmdd10.);
run;
proc print;
  format aeendtc2 lastday yymmddd10.;
run;

data _null_;
    dt = '03APR2017:01:04:34'dt;
    fd = intnx('dtmonth', dt, 0, 'B');
    ld  = intnx('dtmonth', dt, 0, 'E');
    put dt datetime. fd datetime. ld datetime.;
run;

http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/a002605538.htm


## transpose
http://bbs.pinggu.org/thread-3180742-1-1.html


http://hssnow.name/2011/04/dataset-transformation/

TRANSPOSE Procedure

PROC TRANSPOSE
	<DATA=input_ds>
	<DELIMITER=delimiter>
	<LABEL=label>
	<LET>
	<NAME=name>
	<OUT=output_ds>
	<PREFIX=prefix>
	<SUFFIX=suffix>
	;

	BY var(s); 
	COPY var(s);
	ID var;
	IDLABEL vari;
	VAR var(s);


例如：
  PROC TRANSPOSE DATA=score
  				 OUT=score_t(DROP=_NAME_)
  				 PREFIX=subject_;
  		BY stuid;
  		ID subject;
  		VAR score;
  RUN;


SELECT name INTO:names SEPARATED BY "," FROM xxxx


## 索引
https://blog.csdn.net/jjxgmao/article/details/51926567



## SAS编码
> 使用不同的开发语言，对一个项目进行交替作业，编解码真是一个令人头疼的问题。笔者使用了Python和SAS进行SNA社交网络分析项目的开发。Python使用pd.read_sas读取sas数据集，默认读入bytes，如0xCC等，这类字符对人类是不友好的，如果要得到人类可读的字符串，要进行decode。

1. 中文字符的显示与存储

> 一般，遇到解码问题，大部分都是中文，所以，这里以中文来解释，其基本流程是： 屏幕上显示的中文字符 -> encode(gbk，utf-8等方式) -> 存储到介质中 -> decode(gbk、utf-8等方式) -> 显示到屏幕上， encode和decode使用的方式要是一致才可以


2. SAS的中文字符编解码

- 默认的编码、解码方式
- 是否可以更改编码解码方式

3. 字符集&字符编码

4. 实例

- sas生成数据

``` 
libname dt "D:\xieb\sas";

option encoding = "utf-8";

DATA ch;
	ch = "我是中国人";
	en = "I am English";
	ch2 = "屌";
RUN;

FILENAME export "D:\ch.csv" ENCODING="gbk";
PROC EXPORT DATA = ch
			  OUTFILE = export
			  DBMS = CSV REPLACE;
RUN;
```

- python读入数据

```
# -*- coding: utf-8 -*-
"""
Created on Wed Oct 17 14:46:17 2018

@author: TEST
"""

import pandas as pd

df = pd.read_sas(r"D:\ch.sas7bdat", encoding="utf-8")
df2 = pd.read_csv(r"D:\ch.csv")
```

## 参考文献
1. [十分钟搞清字符集和字符编码](http://cenalulu.github.io/linux/character-encoding/)
2. [SAS导入导出时编码问题汇总](http://alitrack.com/2016/11/17/sas%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E6%97%B6%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/)
