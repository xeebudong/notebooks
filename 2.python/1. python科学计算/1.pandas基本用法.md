# pandas 去重计数
> pd.series.unique

# pandas 判断字段是否为数值型、字符型
> np.issubdtype

df = pd.DataFrame({'A': [1, 2, 3], 'B': [1.0, 2.0, 3.0], 
                   'C': [1j, 2j, 3j], 'D': ['a', 'b', 'c']})

np.issubdtype(df['A'].dtype, np.number)

df.select_dtypes(include=[np.number])



# pandas 组内排序

[组内排序](https://zhuanlan.zhihu.com/p/30277559)

# pandas 组内排序，并加上序号
1. [cumcount](http://www.imooc.com/wenda/detail/566046)
2. [groupby+rank](https://blog.csdn.net/u010652755/article/details/90760692)

df = pd.DataFrame([['A',1],['A',3],['A',2],['B',5],['B',9]], columns = ['name','score'])
df["id"] = df["score"].groupby(df["name"]).rank(ascending=True, method="min")



# python 循环日期

```
import datetime
def main():
    begin = datetime.date(2014,6,1)
    end = datetime.date(2014,6,7)
for i in range((end - begin).days+1):
    day = begin + datetime.timedelta(days=i)
    print str(day)
if __name__ == '__main__':
    main()

```

```
# 方式2

import datatime
from dateutil.parser import parse

def int2datatime(integer):
    return parse(str(integer))

start_date = 20180525 #20190525
end_date   = 20190731

for n in range((int2datatime(end_date)-int2datatime(start_date)).days):
#        n=1
        dt     = int2datatime(start_date)+datetime.timedelta(n)
        dt_cur = dt.strftime("%Y%m%d")
#        dt_pre = int((dt + datetime.timedelta(-1)).strftime("%Y%m%d"))
        
        print(dt_cur)
```

# pandas 窗函数
1. [pandas窗函数](https://www.cnblogs.com/jingsupo/p/python-pandas-rolling.html)
```
import pandas as pd
import numpy as np

df = pd.DataFrame({'B': [0, 1, 2, np.nan, 4]})
df["rolling"] = df["B"].rolling(2).sum()
df


df2 = pd.DataFrame({"A":[1,2,3,4,5,6,7], "B":[1,3,2,6,2,5,3]})
df2["roll_b"] = df2["B"].rolling(window=3).mean()
df2

```

# pandas 找出最大行下标
df.values.argmax(axis=1) # axis=1为行，axis=0， 为列