## 1. what is pipe

使用管道操作，可以将一个程序的输出指定为另一个程序的输入，而将一个程序的标准输出连接到另一个程序的标准输入，这种机制叫做管道。目的是将程序1的标准输出连接到程序2，将程序2的标准输出连接到程序3的输入，依次类推。

## 2. pipi的优点

- 使数据处理的顺序结构化为从左到右（而不是从内到外）
- 避免嵌套函数的调用
- 最大限度地减少对局部变量和函数定义的需求
- 可以轻松地在数据处理序列中的任何位置添加步骤

3. 示例

- 不用管道

  加入3个函数，前1个函数的输出为第2个函数的输入，不用管道时如下：

  ```
  def add(a, b):
      return a+b
  
  f1 = add(1, 1)
  f2 = add(f1, 2)
  f3 = add(f2, 3)
  print(f3)
  ```

  


- 使用管道

  ```
  # method 1 
  # pipe库包，需要先安装
  
  
  # method 2
  
  
  from functools import reduce  # reduce算是管道函数吗?
  reduce(add, [1, 2, 3])
  
  # method 2
  from pipe import *
  print(range(5) | where(lambda x:x%2==0) | add)
  ```

## 3. 代码管道化改造



## 4. Python中的无缝管道（即方法链）

```python
from sklearn.datasets import load_iris
import pandas as pd
from random import randint

data_assemble = load_iris()

df = pd.DataFrame(data_assemble["data"])
#df.columns  = data_assemble["feature_names"]
df.columns = ["sepal_length", "sepal_width", "petal_length", "petal_width"]

df["group"] = pd.Series(["A" if randint(1, 3)< 2 else "B" for i in range(df.shape[0])])


# 使用管道来进行汇总统计，实际上，已经在用了
stat_res = (df.query("sepal_length > 5")\
  .filter(["group", "petal_length", "petal_width"])\
  .groupby("group")\
  .agg("mean")\
  .reset_index()\
  .set_axis(["grp", "width_avg", "len_avg"], axis=1))
```

​	

## 参考

1. [独家 | 浅谈Python/Pandas中管道的用法](https://zhuanlan.zhihu.com/p/363296868)
2. [python使用管道模式（pipeline）处理数据](https://zhuanlan.zhihu.com/p/359299883)
3. [python的pipe管道学习](https://www.jianshu.com/p/f0ecf265979e)
4. [JulienPalard Pipe](https://github.com/JulienPalard/Pipe)
